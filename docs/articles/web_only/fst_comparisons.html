<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparisons of Fst computations • assigner</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../../favicon.ico">
<link rel="manifest" href="../../site.webmanifest">
<script src="../../lightswitch.js"></script><script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Comparisons of Fst computations">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">assigner</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../index.html">Installation</a></li>
<li class="nav-item"><a class="nav-link" href="../../FEATURES.html">Features</a></li>
<li class="nav-item"><a class="nav-link" href="../../articles/get_started.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../../articles/get_started.html">Get started</a></li>
    <li><a class="dropdown-item" href="../../articles/fst_confidence_intervals.html">Fst analysis</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/fst_comparisons.html">Comparisons of Fst in 8 packages/software</a></li>
    <li><a class="dropdown-item" href="../../articles/assignment.whitelists.html">Using whitelists in assignment</a></li>
    <li><a class="dropdown-item" href="../../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../../articles/life_cycle.html">Life cycle</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thierrygosselin/assigner" aria-label="GitHub"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Comparisons of Fst computations</h1>
            <h3 data-toc-skip class="subtitle">
<code>assigner</code>,
<code>diveRsity</code>, <code>GenoDive</code>, <code>hierfstat</code>,
<code>SNPRelate</code>, <code>stAMPP</code>, <code>strataG</code>,
<code>VCFtools.</code>
</h3>
                        <h4 data-toc-skip class="author">Thierry
Gosselin</h4>
            
            <h4 data-toc-skip class="date">2025-07-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thierrygosselin/assigner/blob/HEAD/vignettes/web_only/fst_comparisons.Rmd" class="external-link"><code>vignettes/web_only/fst_comparisons.Rmd</code></a></small>
      <div class="d-none name"><code>fst_comparisons.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="goal-of-this-vignette">Goal of this vignette<a class="anchor" aria-label="anchor" href="#goal-of-this-vignette"></a>
</h2>
<p>Compare <code>assigner's</code> Fst calculations (using Weir and
Cockerham, 1984) against alternatives. To make differences and
bottlenecks really stand out we will use a simulated dataset and an
empirical RADseq dataset both with more than 10K markers.</p>
</div>
<div class="section level2">
<h2 id="prepare-your-r-session">Prepare your R session<a class="anchor" aria-label="anchor" href="#prepare-your-r-session"></a>
</h2>
<ul>
<li><p>Highly recommended to clean your workspace:
<code>rm(list = ls())</code></p></li>
<li><p>Put this <strong>Rmd notebook</strong> in the same directory as
the data</p></li>
<li><p>You might be interested in this package called <a href="https://here.r-lib.org" class="external-link">here</a> or use
<code>setwd("/YOUR/NEW/PATH/HERE/")</code>, to change the working
directory.</p></li>
<li><p>Install the R packages below</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install required packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diveRsity"</span>, <span class="st">"hierfstat"</span>, <span class="st">"StAMPP"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'ericarcher/strataG'</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"3.12"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"SNPRelate"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://www.sthda.com/english/wiki/ggcorrplot-visualization-of-a-correlation-matrix-using-ggplot2" class="external-link">"ggcorrplot"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggcorrplot"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"thierrygosselin/assigner"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Versions of packages and software:</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check packages versions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">'assigner'</span><span class="op">)</span> <span class="co"># 0.5.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">'diveRsity'</span><span class="op">)</span> <span class="co"># 1.9.90</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">'hierfstat'</span><span class="op">)</span> <span class="co"># 0.5.7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">'stAMPP'</span><span class="op">)</span> <span class="co"># 1.6.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">'strataG'</span><span class="op">)</span> <span class="co"># 2.4.910</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">'SNPRelate'</span><span class="op">)</span> <span class="co"># 1.24.0</span></span></code></pre></div>
<p><strong>Optional software:</strong></p>
<ul>
<li>
<a href="http://www.bentleydrummer.nl/software/software/GenoDive.html" class="external-link">GenoDive
macOS only</a> (v.3.04)</li>
<li>
<a href="https://vcftools.github.io" class="external-link">VCFtools</a> (v.0.1.17)</li>
</ul>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<div class="section level3">
<h3 id="empirical-dataset">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset"></a>
</h3>
<p>We’re going to use the unfiltered vcf sunflower dataset from Owens et
al. 2016, kindly provided by Gregory Owens. This dataset as missing
data.</p>
<p>Owens GL, Baute GJ, Rieseberg LH. Revisiting a classic case of
introgression: hybridization and gene flow in Californian sunflowers.
Abbott RJ, Barton NH, Good JM, editors. Molecular Ecology. 2016;25:
2630–2643. <a href="doi:10.1111/mec.13569" class="uri">doi:10.1111/mec.13569</a></p>
<p><strong>Download the files:</strong></p>
<ul>
<li><a href="https://www.dropbox.com/s/3kfx351ijeaa1wr/sunflower.vcf?dl=0" class="external-link">vcf</a></li>
<li>
<a href="https://www.dropbox.com/s/406jleg3imwfaup/sunflower.strata.tsv?dl=0" class="external-link">strata</a>.
What’s a strata file ? Read the <a href="https://thierrygosselin.github.io/radiator/reference/read_strata.html" class="external-link">doc</a>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="simulated-datasets">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets"></a>
</h3>
<p>After running this vignette once, I saw something strange in the
results. To explore this further, this second grind of testing add 2
additional datasets: <a href="http://thierrygosselin.github.io/assigner/reference/data_assigner_sim_01.html" class="external-link">data_assigner_sim_01</a>
and <a href="http://thierrygosselin.github.io/assigner/reference/data_assigner_sim_02.html" class="external-link">data_assigner_sim_02</a>.
The documentation explains how these simulated data were produced. They
differ mainly in migration rate which resulted in contrastingly
different Fst, admixture/membership probability.</p>
</div>
</div>
<div class="section level2">
<h2 id="generate-the-output-files">Generate the output files<a class="anchor" aria-label="anchor" href="#generate-the-output-files"></a>
</h2>
<p>We use <a href="https://thierrygosselin.github.io/radiator/reference/genomic_converter.html" class="external-link">radiator::genomic_converter</a>
to produce the required files or R objects:</p>
<div class="section level3">
<h3 id="empirical-dataset-1">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-1"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://thierrygosselin.github.io/assigner/">assigner</a></span><span class="op">)</span></span>
<span><span class="co"># radiator is installed automatically with assigner</span></span>
<span><span class="va">sunflower.filtered</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/genomic_converter.html" class="external-link">genomic_converter</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="st">"sunflower.vcf"</span>, </span>
<span>  strata <span class="op">=</span> <span class="st">"sunflower.strata.tsv"</span>, </span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"genepop"</span>, <span class="co"># for GenoDive and diveRsity</span></span>
<span>    <span class="st">"gtypes"</span>, <span class="co"># for strataG</span></span>
<span>    <span class="st">"genlight"</span>, <span class="co"># for StAMPP</span></span>
<span>    <span class="st">"hierfstat"</span>, <span class="co"># for Hierfstat</span></span>
<span>    <span class="st">"snprelate"</span> <span class="co"># for SNPRelate</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>VCF stats:</p>
<ul>
<li>the original number of markers is 34258.</li>
<li>by default, <code><a href="https://thierrygosselin.github.io/radiator/reference/genomic_converter.html" class="external-link">radiator::genomic_converter</a></code> will only keep
polymorphic markers in common between the strata.</li>
<li>15973 biallelic markers are recovered.</li>
<li>Number of populations: 9</li>
<li>Number of individuals: 88</li>
</ul>
<p>The <code>sunflower.filtered</code> object is a list with several
objects inside:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sunflower.filtered</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "hierfstat" "gtypes"    "genlight"  "snprelate" "tidy.data"</span></span>
<span><span class="co"># the tidy dataset is used by assigner</span></span></code></pre></div>
<p>The function also produced a folder with several files,
including:</p>
<ul>
<li>the genepop file</li>
<li>the SNPRelate GDS file</li>
<li>the hierfstat file</li>
<li>the gtypes file</li>
<li>the genlight file</li>
<li>the tidy data file</li>
</ul>
<p>To learn more about the output folders and files: <a href="https://thierrygosselin.github.io/radiator/reference/genomic_converter.html" class="external-link">radiator::genomic_converter</a></p>
<p><em>Note on timing</em></p>
<p>I could use fancy timing packages (<a href="https://github.com/joshuaulrich/microbenchmark" class="external-link">microbenchmark</a>,
<a href="http://bench.r-lib.org" class="external-link">bench</a>), but for simplicity we’re
just going to use <code>system.time</code>.</p>
</div>
<div class="section level3">
<h3 id="simulated-datasets-1">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-1"></a>
</h3>
<div class="section level4">
<h4 id="sim_01">sim_01<a class="anchor" aria-label="anchor" href="#sim_01"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_assigner_sim_01</span> <span class="op"><a href="../../reference/compound_assignment_pipe_operator.html">%&lt;&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>POP_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">POP_ID</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP_1"</span>, <span class="st">"POP_2"</span>, <span class="st">"POP_3"</span>, <span class="st">"POP_4"</span>, <span class="st">"POP_5"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP_ID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim.data1</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/genomic_converter.html" class="external-link">genomic_converter</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_assigner_sim_01</span>, </span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"genepop"</span>, <span class="co"># for GenoDive and diveRsity</span></span>
<span>    <span class="st">"gtypes"</span>, <span class="co"># for strataG</span></span>
<span>    <span class="st">"genlight"</span>, <span class="co"># for StAMPP</span></span>
<span>    <span class="st">"hierfstat"</span>, <span class="co"># for Hierfstat</span></span>
<span>    <span class="st">"snprelate"</span> <span class="co"># for SNPRelate</span></span>
<span>  <span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">"sim01"</span>,</span>
<span>  path.folder <span class="op">=</span> <span class="st">"fst_sim01"</span>,</span>
<span>  internal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim.data1</span><span class="op">$</span><span class="va">tidy.data</span> <span class="op"><a href="../../reference/compound_assignment_pipe_operator.html">%&lt;&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP_ID</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sim_02">sim_02<a class="anchor" aria-label="anchor" href="#sim_02"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_assigner_sim_02</span> <span class="op"><a href="../../reference/compound_assignment_pipe_operator.html">%&lt;&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>POP_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">POP_ID</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP_1"</span>, <span class="st">"POP_2"</span>, <span class="st">"POP_3"</span>, <span class="st">"POP_4"</span>, <span class="st">"POP_5"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP_ID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim.data2</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/genomic_converter.html" class="external-link">genomic_converter</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_assigner_sim_02</span>, </span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"genepop"</span>, <span class="co"># for GenoDive and diveRsity</span></span>
<span>    <span class="st">"gtypes"</span>, <span class="co"># for strataG</span></span>
<span>    <span class="st">"genlight"</span>, <span class="co"># for StAMPP</span></span>
<span>    <span class="st">"hierfstat"</span>, <span class="co"># for Hierfstat</span></span>
<span>    <span class="st">"snprelate"</span> <span class="co"># for SNPRelate</span></span>
<span>  <span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="st">"sim02"</span>,</span>
<span>  path.folder <span class="op">=</span> <span class="st">"fst_sim02"</span>,</span>
<span>  internal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim.data2</span><span class="op">$</span><span class="va">tidy.data</span> <span class="op"><a href="../../reference/compound_assignment_pipe_operator.html">%&lt;&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP_ID</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="hierfstat">hierfstat<a class="anchor" aria-label="anchor" href="#hierfstat"></a>
</h2>
<p>Let’s start with the Gold Standard, Jérôme Goudet’s <a href="https://github.com/jgx65/hierfstat" class="external-link">hierfstat</a> package.</p>
<div class="section level3">
<h3 id="empirical-dataset-2">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-2"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ETA ~ 30 min on my MBP, so yes, you have time for coffee...</span></span>
<span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span><span class="co"># pop string</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">hierfstat.fst</span> <span class="op">&lt;-</span> <span class="fu">hierfstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hierfstat/man/pairwise.WCfst.html" class="external-link">pairwise.WCfst</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">hierfstat</span>, </span>
<span>    diploid <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># The result need some work</span></span>
<span>    <span class="co"># We transform the matrix into a useful tibble:</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>, remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, remove.lower <span class="op">=</span> <span class="cn">TRUE</span>, na.diag <span class="op">=</span> <span class="cn">TRUE</span>, relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span>, <span class="st">"HIERFSTAT"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP1</span>, <span class="va">POP2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; 1233.880sec ~20 min</span></span>
<span><span class="va">hierfstat.fst</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulated-datasets-2">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-2"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sim.data1</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span><span class="co"># pop string</span></span>
<span><span class="va">hierfstat.sim01.fst</span> <span class="op">&lt;-</span> <span class="fu">hierfstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hierfstat/man/pairwise.WCfst.html" class="external-link">pairwise.WCfst</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">sim.data1</span><span class="op">$</span><span class="va">hierfstat</span>, </span>
<span>    diploid <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># The result need some work</span></span>
<span>    <span class="co"># We transform the matrix into a useful tibble:</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>, remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, remove.lower <span class="op">=</span> <span class="cn">TRUE</span>, na.diag <span class="op">=</span> <span class="cn">TRUE</span>, relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span>, <span class="st">"HIERFSTAT_SIM01"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP1</span>, <span class="va">POP2</span><span class="op">)</span></span>
<span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sim.data2</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span><span class="co"># pop string</span></span>
<span>  <span class="va">hierfstat.sim02.fst</span> <span class="op">&lt;-</span> <span class="fu">hierfstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hierfstat/man/pairwise.WCfst.html" class="external-link">pairwise.WCfst</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">sim.data2</span><span class="op">$</span><span class="va">hierfstat</span>, </span>
<span>    diploid <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># The result need some work</span></span>
<span>    <span class="co"># We transform the matrix into a useful tibble:</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>, remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, remove.lower <span class="op">=</span> <span class="cn">TRUE</span>, na.diag <span class="op">=</span> <span class="cn">TRUE</span>, relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span>, <span class="st">"HIERFSTAT_SIM02"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP1</span>, <span class="va">POP2</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="stratag">strataG<a class="anchor" aria-label="anchor" href="#stratag"></a>
</h2>
<p>This is Eric Archer’s <a href="https://github.com/EricArcher/strataG" class="external-link">strataG</a> package.</p>
<div class="section level3">
<h3 id="empirical-dataset-3">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-3"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">stratag.fst</span> <span class="op">&lt;-</span> <span class="fu">strataG</span><span class="fu">::</span><span class="fu">popStructTest</span><span class="op">(</span></span>
<span>    g <span class="op">=</span> <span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">gtypes</span>, </span>
<span>    stats <span class="op">=</span> <span class="st">"fst"</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"both"</span>, </span>
<span>    quietly <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    max.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>    nrep <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    keep.null <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    write.output <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>    <span class="va">pairwise</span><span class="op">$</span><span class="va">result</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>POP1 <span class="op">=</span> <span class="va">strata.1</span>, POP2 <span class="op">=</span> <span class="va">strata.2</span>, STRATAG <span class="op">=</span> <span class="va">Fst</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">stratag.fst</span></span>
<span><span class="co">#&gt;657.377sec ~ 11 min</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulated-datasets-3">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-3"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stratag.sim01.fst</span> <span class="op">&lt;-</span> <span class="fu">strataG</span><span class="fu">::</span><span class="fu">popStructTest</span><span class="op">(</span></span>
<span>    g <span class="op">=</span> <span class="va">sim.data1</span><span class="op">$</span><span class="va">gtypes</span>, </span>
<span>    stats <span class="op">=</span> <span class="st">"fst"</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"both"</span>, </span>
<span>    quietly <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    max.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>    nrep <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    keep.null <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    write.output <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>    <span class="va">pairwise</span><span class="op">$</span><span class="va">result</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>POP1 <span class="op">=</span> <span class="va">strata.1</span>, POP2 <span class="op">=</span> <span class="va">strata.2</span>, STRATAG_SIM01 <span class="op">=</span> <span class="va">Fst</span><span class="op">)</span></span>
<span><span class="va">stratag.sim02.fst</span> <span class="op">&lt;-</span> <span class="fu">strataG</span><span class="fu">::</span><span class="fu">popStructTest</span><span class="op">(</span></span>
<span>    g <span class="op">=</span> <span class="va">sim.data2</span><span class="op">$</span><span class="va">gtypes</span>, </span>
<span>    stats <span class="op">=</span> <span class="st">"fst"</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"both"</span>, </span>
<span>    quietly <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    max.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>    nrep <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    keep.null <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    write.output <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>    <span class="va">pairwise</span><span class="op">$</span><span class="va">result</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>POP1 <span class="op">=</span> <span class="va">strata.1</span>, POP2 <span class="op">=</span> <span class="va">strata.2</span>, STRATAG_SIM02 <span class="op">=</span> <span class="va">Fst</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="diversity">diveRsity<a class="anchor" aria-label="anchor" href="#diversity"></a>
</h2>
<ul>
<li>Kevin Keenan’s <a href="http://diversityinlife.weebly.com/software.html" class="external-link">diveRsity</a>
package requires the <code>genepop</code> file.</li>
<li>the function is optimized with C++, so no need for a coffee (&lt; 1
min on my MBP)</li>
</ul>
<div class="section level3">
<h3 id="empirical-dataset-4">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-4"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span> <span class="co"># pop string</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">diversity.fst</span> <span class="op">&lt;-</span> <span class="fu">diveRsity</span><span class="fu">::</span><span class="fu">diffCalc</span><span class="op">(</span></span>
<span>    infile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>      path <span class="op">=</span> <span class="st">"."</span>, </span>
<span>      pattern <span class="op">=</span> <span class="st">"_genepop.gen"</span>, </span>
<span>      full.names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      recursive <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>, </span>
<span>    outfile <span class="op">=</span> <span class="st">"sunflower_diversity_output"</span>, </span>
<span>    fst <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    pairwise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    para <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>    <span class="va">pairwise</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>    <span class="va">Fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># The result need some work</span></span>
<span>    <span class="co"># We transform the matrix into a useful tibble:</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>, </span>
<span>      remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      remove.lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># FALSE because their's only the lower diag</span></span>
<span>      na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># we switch the POP id column here to match the others</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP2"</span>, <span class="st">"POP1"</span>, <span class="st">"DIVERSITY"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; 42.711 sec Wow! this is very fast, plus other distances are automatically generated!</span></span>
<span><span class="va">diversity.fst</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulated-datasets-4">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-4"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sim.data1</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span> <span class="co"># pop string</span></span>
<span><span class="va">diversity.sim01.fst</span> <span class="op">&lt;-</span> <span class="fu">diveRsity</span><span class="fu">::</span><span class="fu">diffCalc</span><span class="op">(</span></span>
<span>  infile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"."</span>, </span>
<span>    pattern <span class="op">=</span> <span class="st">"sim01_genepop.gen"</span>, </span>
<span>    full.names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    recursive <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>, </span>
<span>  outfile <span class="op">=</span> <span class="st">"sim_data1_diversity_output"</span>, </span>
<span>  fst <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pairwise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  para <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>  <span class="va">pairwise</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>  <span class="va">Fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># The result need some work</span></span>
<span>  <span class="co"># We transform the matrix into a useful tibble:</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>, </span>
<span>    remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    remove.lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># FALSE because their's only the lower diag</span></span>
<span>    na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># we switch the POP id column here to match the others</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP2"</span>, <span class="st">"POP1"</span>, <span class="st">"DIVERSITY_SIM01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sim.data2</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span> <span class="co"># pop string</span></span>
<span><span class="va">diversity.sim02.fst</span> <span class="op">&lt;-</span> <span class="fu">diveRsity</span><span class="fu">::</span><span class="fu">diffCalc</span><span class="op">(</span></span>
<span>  infile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="st">"."</span>, </span>
<span>    pattern <span class="op">=</span> <span class="st">"sim02_genepop.gen"</span>, </span>
<span>    full.names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    recursive <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,  </span>
<span>  outfile <span class="op">=</span> <span class="st">"sim_data2_diversity_output"</span>, </span>
<span>  fst <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pairwise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  para <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>  <span class="va">pairwise</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>  <span class="va">Fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># The result need some work</span></span>
<span>  <span class="co"># We transform the matrix into a useful tibble:</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>, </span>
<span>    remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    remove.lower <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># FALSE because their's only the lower diag</span></span>
<span>    na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># we switch the POP id column here to match the others</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP2"</span>, <span class="st">"POP1"</span>, <span class="st">"DIVERSITY_SIM02"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="snprelate">SNPRelate<a class="anchor" aria-label="anchor" href="#snprelate"></a>
</h2>
<ul>
<li>Xiuwen Zheng’s <a href="https://github.com/zhengxwen/SNPRelate" class="external-link">SNPRelate</a> package is
very fast.</li>
<li>No out-of-the-box pairwise Fst analysis. So I implemented my own
below.</li>
</ul>
<div class="section level3">
<h3 id="empirical-dataset-5">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-5"></a>
</h3>
<p>We need the strata</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/read_strata.html" class="external-link">read_strata</a></span><span class="op">(</span>strata <span class="op">=</span> <span class="st">"sunflower.strata.tsv"</span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span> <span class="va">strata</span></span></code></pre></div>
<p>Showing off the global Fst only:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">snprelate.fst</span> <span class="op">&lt;-</span> <span class="fu">SNPRelate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsFst.html" class="external-link">snpgdsFst</a></span><span class="op">(</span></span>
<span>    gdsobj <span class="op">=</span> <span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">snprelate</span>,</span>
<span>    population <span class="op">=</span> <span class="va">strata</span><span class="op">$</span><span class="va">STRATA</span>, <span class="co"># factors required</span></span>
<span>    sample.id <span class="op">=</span> <span class="va">strata</span><span class="op">$</span><span class="va">INDIVIDUALS</span>,</span>
<span>    snp.id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"W&amp;C84"</span>,</span>
<span>    remove.monosnp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    maf <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>    missing.rate <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>    autosome.only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    with.id <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.029sec wo!</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">snprelate.fst</span><span class="op">)</span></span>
<span><span class="co">#&gt; snprelate.fst$Fst: weighted Fst estimate</span></span>
<span><span class="co">#&gt; snprelate.fst$MeanFst: the average of Fst estimates across SNPs</span></span>
<span><span class="co">#&gt; snprelate.fst$FstSNP: a vector of Fst for each SNP</span></span></code></pre></div>
<p>Build a function to conduct pairwise Fst with SNPRelate:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairwise_fst_snprelate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pop.pairwise</span>, <span class="va">data</span>, <span class="va">strata</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">strata.temp</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span>.data <span class="op">=</span> <span class="va">strata</span>, <span class="va">STRATA</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pop.pairwise</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STRATA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">STRATA</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fst</span> <span class="op">&lt;-</span> <span class="fu">SNPRelate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SNPRelate/man/snpgdsFst.html" class="external-link">snpgdsFst</a></span><span class="op">(</span></span>
<span>    gdsobj <span class="op">=</span> <span class="va">data</span>,</span>
<span>    population <span class="op">=</span> <span class="va">strata.temp</span><span class="op">$</span><span class="va">STRATA</span>, <span class="co"># factors required</span></span>
<span>    sample.id <span class="op">=</span> <span class="va">strata.temp</span><span class="op">$</span><span class="va">INDIVIDUALS</span>,</span>
<span>    snp.id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"W&amp;C84"</span>,</span>
<span>    remove.monosnp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    maf <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>    missing.rate <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>    autosome.only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    with.id <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co">#prepare the results into a tibble:</span></span>
<span>  <span class="va">fst</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    POP1 <span class="op">=</span> <span class="va">pop.pairwise</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>    POP2 <span class="op">=</span> <span class="va">pop.pairwise</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>    SNPRELATE_MEAN <span class="op">=</span> <span class="va">fst</span><span class="op">$</span><span class="va">MeanFst</span>,</span>
<span>    SNPRELATE_WEIGHTED <span class="op">=</span> <span class="va">fst</span><span class="op">$</span><span class="va">Fst</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">fst</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To run we need all combination of populations:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop.pairwise</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">strata</span><span class="op">$</span><span class="va">STRATA</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Run the pairwise implementation:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">snprelate.fst</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="va">pop.pairwise</span>,</span>
<span>    .f <span class="op">=</span> <span class="va">pairwise_fst_snprelate</span>,</span>
<span>    data <span class="op">=</span> <span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">snprelate</span>,</span>
<span>    strata <span class="op">=</span> <span class="va">strata</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.245 sec that's the fastest so far!</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulated-datasets-5">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-5"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/generate_strata.html" class="external-link">generate_strata</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim.data1</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>STRATA <span class="op">=</span> <span class="va">POP_ID</span><span class="op">)</span></span>
<span><span class="va">pop.pairwise</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">strata</span><span class="op">$</span><span class="va">STRATA</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">snprelate.sim01.fst</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="va">pop.pairwise</span>,</span>
<span>  .f <span class="op">=</span> <span class="va">pairwise_fst_snprelate</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sim.data1</span><span class="op">$</span><span class="va">snprelate</span>,</span>
<span>  strata <span class="op">=</span> <span class="va">strata</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>SNPRELATE_MEAN_SIM01 <span class="op">=</span> <span class="va">SNPRELATE_MEAN</span>, SNPRELATE_WEIGHTED_SIM01 <span class="op">=</span> <span class="va">SNPRELATE_WEIGHTED</span><span class="op">)</span></span>
<span></span>
<span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/generate_strata.html" class="external-link">generate_strata</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim.data2</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>STRATA <span class="op">=</span> <span class="va">POP_ID</span><span class="op">)</span></span>
<span><span class="va">pop.pairwise</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">strata</span><span class="op">$</span><span class="va">STRATA</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">snprelate.sim02.fst</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="va">pop.pairwise</span>,</span>
<span>  .f <span class="op">=</span> <span class="va">pairwise_fst_snprelate</span>,</span>
<span>  data <span class="op">=</span> <span class="va">sim.data2</span><span class="op">$</span><span class="va">snprelate</span>,</span>
<span>  strata <span class="op">=</span> <span class="va">strata</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>SNPRELATE_MEAN_SIM02 <span class="op">=</span> <span class="va">SNPRELATE_MEAN</span>, SNPRELATE_WEIGHTED_SIM02 <span class="op">=</span> <span class="va">SNPRELATE_WEIGHTED</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="genodive">GenoDive<a class="anchor" aria-label="anchor" href="#genodive"></a>
</h2>
<ul>
<li>Inside Patrick Meirmans’s <a href="http://www.bentleydrummer.nl/software/software/GenoDive.html" class="external-link">GenoDive</a>
software, <em>import</em> or <em>drag</em> the <code>genepop</code>
file</li>
<li>Run:
<code>Analysis -&gt; Pairwise Differentiation -&gt; F_st</code>, choose
<code>1 permutations</code>.</li>
<li>Save the results or copy/paste in MS Excel or text editor:
<strong>genodive.fst.tsv</strong>.</li>
<li>no need for a coffee, <code>GenoDive</code> is coded in Objective-C
(~ &lt; 3 sec on my MBP)</li>
</ul>
<div class="section level3">
<h3 id="empirical-dataset-6">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-6"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import in R</span></span>
<span><span class="co"># Add the proper columns and rows names</span></span>
<span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span> <span class="co"># pop string</span></span>
<span><span class="va">genodive.fst</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"genodive.fst.tsv"</span>,</span>
<span>  col_names <span class="op">=</span> <span class="va">pops</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>, </span>
<span>    remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    remove.lower <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># FALSE because their's only the lower diag</span></span>
<span>    na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span>, <span class="st">"GENODIVE"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">genodive.fst</span></span></code></pre></div>
<p>Obviously, here the timing gets doesn’t reflect the whole
process:</p>
<ul>
<li>the data as to be imported in GenoDive</li>
<li>several manipulations of the results are required to get from
GenoDive to R</li>
</ul>
</div>
<div class="section level3">
<h3 id="simulated-datasets-6">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-6"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sim.data1</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span> <span class="co"># pop string</span></span>
<span><span class="va">genodive.sim01.fst</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>      path <span class="op">=</span> <span class="st">"."</span>, </span>
<span>      pattern <span class="op">=</span> <span class="st">"genodive.sim01.fst.tsv"</span>, </span>
<span>      full.names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      recursive <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>  col_names <span class="op">=</span> <span class="va">pops</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>, </span>
<span>    remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    remove.lower <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># FALSE because their's only the lower diag</span></span>
<span>    na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span>, <span class="st">"GENODIVE_SIM01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sim.data2</span><span class="op">$</span><span class="va">tidy.data</span><span class="op">$</span><span class="va">POP_ID</span><span class="op">)</span><span class="op">)</span> <span class="co"># pop string</span></span>
<span><span class="va">genodive.sim02.fst</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>      path <span class="op">=</span> <span class="st">"."</span>, </span>
<span>      pattern <span class="op">=</span> <span class="st">"genodive.sim02.fst.tsv"</span>, </span>
<span>      full.names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      recursive <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>  col_names <span class="op">=</span> <span class="va">pops</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_rownames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="va">pops</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">.</span>, </span>
<span>    remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    remove.lower <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># FALSE because their's only the lower diag</span></span>
<span>    na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span>, <span class="st">"GENODIVE_SIM02"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="stampp">StAMPP<a class="anchor" aria-label="anchor" href="#stampp"></a>
</h2>
<p>Luke Pembleton’s <code>StAMPP</code> package use
<code>genlight</code> object as input:</p>
<div class="section level3">
<h3 id="empirical-dataset-7">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-7"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">stampp.fst</span> <span class="op">&lt;-</span> <span class="fu">StAMPP</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/StAMPP/man/stamppFst.html" class="external-link">stamppFst</a></span><span class="op">(</span></span>
<span>    geno <span class="op">=</span> <span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">genlight</span>, </span>
<span>    nboots <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    percent <span class="op">=</span> <span class="fl">95</span>, </span>
<span>    nclusters <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># The distance matrix need some love</span></span>
<span>    <span class="co"># if we want to compare it with the others:</span></span>
<span>    <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>, </span>
<span>      remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      remove.lower <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>      na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># we switch the POP id column here to match the others</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP2"</span>, <span class="st">"POP1"</span>, <span class="st">"STAMPP"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP1</span>, <span class="va">POP2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; 39.281 sec!</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulated-datasets-7">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-7"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stampp.sim01.fst</span> <span class="op">&lt;-</span> <span class="fu">StAMPP</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/StAMPP/man/stamppFst.html" class="external-link">stamppFst</a></span><span class="op">(</span></span>
<span>    geno <span class="op">=</span> <span class="va">sim.data1</span><span class="op">$</span><span class="va">genlight</span>, </span>
<span>    nboots <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    percent <span class="op">=</span> <span class="fl">95</span>, </span>
<span>    nclusters <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># The distance matrix need some love</span></span>
<span>    <span class="co"># if we want to compare it with the others:</span></span>
<span>    <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>, </span>
<span>      remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      remove.lower <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>      na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># we switch the POP id column here to match the others</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP2"</span>, <span class="st">"POP1"</span>, <span class="st">"STAMPP_SIM01"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP1</span>, <span class="va">POP2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stampp.sim02.fst</span> <span class="op">&lt;-</span> <span class="fu">StAMPP</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/StAMPP/man/stamppFst.html" class="external-link">stamppFst</a></span><span class="op">(</span></span>
<span>    geno <span class="op">=</span> <span class="va">sim.data2</span><span class="op">$</span><span class="va">genlight</span>, </span>
<span>    nboots <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    percent <span class="op">=</span> <span class="fl">95</span>, </span>
<span>    nclusters <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># The distance matrix need some love</span></span>
<span>    <span class="co"># if we want to compare it with the others:</span></span>
<span>    <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">.</span>, </span>
<span>      remove.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      remove.lower <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>      na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>      relative <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># we switch the POP id column here to match the others</span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP2"</span>, <span class="st">"POP1"</span>, <span class="st">"STAMPP_SIM02"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">POP1</span>, <span class="va">POP2</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="vcftools">VCFtools<a class="anchor" aria-label="anchor" href="#vcftools"></a>
</h2>
<p>I’m not particularly fond of VCFtools for Fst. Too much manipulation
of files. For the sake of the exercise I’m going to compare it quickly
with 2 populations for the empirical dataset only.</p>
<div class="section level3">
<h3 id="empirical-dataset-8">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-8"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop1</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">strata</span>, <span class="va">STRATA</span> <span class="op">==</span> <span class="st">"G100"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">INDIVIDUALS</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, path <span class="op">=</span> <span class="st">"pop1.txt"</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pop2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">strata</span>, <span class="va">STRATA</span> <span class="op">==</span> <span class="st">"G102"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">INDIVIDUALS</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, path <span class="op">=</span> <span class="st">"pop2.txt"</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>the command used:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">vcftools</span> <span class="at">--vcf</span> sunflower.vcf <span class="at">--weir-fst-pop</span> pop1.txt <span class="at">--weir-fst-pop</span> pop2.txt <span class="at">--out</span> pop1_vs_pop2 </span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#&gt; Fst between G100 and G102:</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; Weir and Cockerham mean Fst estimate: 0.036903</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt; Weir and Cockerham weighted Fst estimate: 0.16222</span></span></code></pre></div>
<p>PLINK users, note that the <code>--fst</code> option in <a href="https://www.cog-genomics.org/plink/1.9/basic_stats#fst" class="external-link">PLINK
v.1.9</a> is actually a port of VCFtools..</p>
<p>For me, comparison with VCFtools stops here, too painfull to conduct
more pairwise, getting the ouput ready for R, etc. This is prone to
human error and too much work to automate for no benefit (below you’ll
understand how those VCFtools results compares with the other
packages).</p>
</div>
<div class="section level3">
<h3 id="simulated-datasets-8">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-8"></a>
</h3>
<p><em>not conducted</em></p>
</div>
</div>
<div class="section level2">
<h2 id="assigner">assigner<a class="anchor" aria-label="anchor" href="#assigner"></a>
</h2>
<div class="section level3">
<h3 id="empirical-dataset-9">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-9"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assigner.fst</span> <span class="op">&lt;-</span> <span class="fu">assigner</span><span class="fu">::</span><span class="fu"><a href="../../reference/fst_WC84.html">fst_WC84</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sunflower.filtered</span><span class="op">$</span><span class="va">tidy.data</span>, </span>
<span>  pairwise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>  <span class="va">pairwise.fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ASSIGNER <span class="op">=</span> <span class="va">FST</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">N_MARKERS</span><span class="op">)</span></span>
<span><span class="co">#&gt; 49 sec</span></span>
<span><span class="va">assigner.fst</span></span></code></pre></div>
<p>Learn more about <code><a href="../../reference/fst_WC84.html">assigner::fst_WC84</a></code> with the dedicated
<a href="http://thierrygosselin.github.io/assigner/articles/fst_confidence_intervals.html" class="external-link">vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="simulated-datasets-9">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-9"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assigner.sim01.fst</span> <span class="op">&lt;-</span> <span class="fu">assigner</span><span class="fu">::</span><span class="fu"><a href="../../reference/fst_WC84.html">fst_WC84</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim.data1</span><span class="op">$</span><span class="va">tidy.data</span>, </span>
<span>  pairwise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>  <span class="va">pairwise.fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ASSIGNER_SIM01 <span class="op">=</span> <span class="va">FST</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">N_MARKERS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">assigner.sim02.fst</span> <span class="op">&lt;-</span> <span class="fu">assigner</span><span class="fu">::</span><span class="fu"><a href="../../reference/fst_WC84.html">fst_WC84</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim.data2</span><span class="op">$</span><span class="va">tidy.data</span>, </span>
<span>  pairwise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span></span>
<span>  <span class="va">pairwise.fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ASSIGNER_SIM02 <span class="op">=</span> <span class="va">FST</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">N_MARKERS</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparisons">Comparisons<a class="anchor" aria-label="anchor" href="#comparisons"></a>
</h2>
<div class="section level3">
<h3 id="empirical-dataset-10">Empirical dataset<a class="anchor" aria-label="anchor" href="#empirical-dataset-10"></a>
</h3>
<div class="section level4">
<h4 id="generate-a-summary-tibble">Generate a summary tibble<a class="anchor" aria-label="anchor" href="#generate-a-summary-tibble"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span>  <span class="va">assigner.fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">diversity.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">genodive.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">hierfstat.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">stampp.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">stratag.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">snprelate.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you haven’t run the codes above:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.summary</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"fst.summary.tsv"</span>, col_types <span class="op">=</span> <span class="st">"ccnnnnnnnn"</span><span class="op">)</span></span>
<span><span class="va">fst.summary</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 36 × 10</span></span></span>
<span><span class="co">##    POP1  POP2  ASSIGNER DIVERSITY GENODIVE HIERFSTAT STAMPP STRATAG</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> G100  G102     0.123     0.123    0.115     0.123  0.123   0.123</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> G100  G103     0.210     0.210    0.215     0.210  0.211   0.211</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> G100  G108     0.394     0.395    0.39      0.394  0.394   0.394</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> G100  G109     0.299     0.299    0.287     0.299  0.299   0.299</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> G100  G111     0.369     0.370    0.356     0.369  0.369   0.369</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> G100  G118     0.169     0.169    0.156     0.169  0.169   0.169</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> G100  G122     0.269     0.270    0.255     0.269  0.269   0.269</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> G100  G124     0.366     0.366    0.362     0.366  0.366   0.366</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> G102  G103     0.118     0.118    0.115     0.118  0.119   0.119</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> G102  G108     0.322     0.323    0.319     0.322  0.322   0.322</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 26 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: SNPRELATE_MEAN &lt;dbl&gt;, SNPRELATE_WEIGHTED &lt;dbl&gt;</span></span></span></code></pre>
<p>If we highlight the first line, pops G100 and G102:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fst.summary</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1L</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 10</span></span></span>
<span><span class="co">##   POP1  POP2  ASSIGNER DIVERSITY GENODIVE HIERFSTAT STAMPP STRATAG</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> G100  G102     0.123     0.123    0.115     0.123  0.123   0.123</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: SNPRELATE_MEAN &lt;dbl&gt;, SNPRELATE_WEIGHTED &lt;dbl&gt;</span></span></span></code></pre>
<p><strong>Gold Standard</strong>: HIERFSTAT 0.12</p>
<ul>
<li>min value: SNPRELATE_MEAN 0.08</li>
<li>max value: SNPRELATE_WEIGHTED 0.14</li>
<li>Weir and Cockerham mean Fst estimate: 0.036903 !!!</li>
<li>Weir and Cockerham weighted Fst estimate: 0.16222 !!!</li>
<li>that’s a bit scary…</li>
</ul>
</div>
<div class="section level4">
<h4 id="generate-a-correlation-matrix">Generate a correlation matrix<a class="anchor" aria-label="anchor" href="#generate-a-correlation-matrix"></a>
</h4>
<p>There’s obviously differences when we look at the pairwise
comparisons separately. The difference between the approaches taken in
the packages/software probably depends on numerous things:</p>
<ul>
<li>how common polymorphic markers are handle</li>
<li>how sample size differences are managed</li>
<li>missing data</li>
<li>rouding during steps of the codes</li>
</ul>
<p>Let’s look at it globally with a correlation matrix:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fst.summary</span>, <span class="op">-</span><span class="va">POP1</span>, <span class="op">-</span><span class="va">POP2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">fst.corr</span></span></code></pre></div>
<pre><code><span><span class="co">##                    ASSIGNER DIVERSITY GENODIVE HIERFSTAT   STAMPP  STRATAG</span></span>
<span><span class="co">## ASSIGNER           1.000000  0.999998 0.997723  1.000000 0.999996 0.999996</span></span>
<span><span class="co">## DIVERSITY          0.999998  1.000000 0.997635  0.999998 0.999995 0.999995</span></span>
<span><span class="co">## GENODIVE           0.997723  0.997635 1.000000  0.997723 0.997702 0.997702</span></span>
<span><span class="co">## HIERFSTAT          1.000000  0.999998 0.997723  1.000000 0.999996 0.999996</span></span>
<span><span class="co">## STAMPP             0.999996  0.999995 0.997702  0.999996 1.000000 1.000000</span></span>
<span><span class="co">## STRATAG            0.999996  0.999995 0.997702  0.999996 1.000000 1.000000</span></span>
<span><span class="co">## SNPRELATE_MEAN     0.973732  0.974023 0.965324  0.973732 0.973953 0.973953</span></span>
<span><span class="co">## SNPRELATE_WEIGHTED 0.996752  0.996691 0.998345  0.996752 0.996729 0.996729</span></span>
<span><span class="co">##                    SNPRELATE_MEAN SNPRELATE_WEIGHTED</span></span>
<span><span class="co">## ASSIGNER                 0.973732           0.996752</span></span>
<span><span class="co">## DIVERSITY                0.974023           0.996691</span></span>
<span><span class="co">## GENODIVE                 0.965324           0.998345</span></span>
<span><span class="co">## HIERFSTAT                0.973732           0.996752</span></span>
<span><span class="co">## STAMPP                   0.973953           0.996729</span></span>
<span><span class="co">## STRATAG                  0.973953           0.996729</span></span>
<span><span class="co">## SNPRELATE_MEAN           1.000000           0.962916</span></span>
<span><span class="co">## SNPRELATE_WEIGHTED       0.962916           1.000000</span></span></code></pre>
<p>I prefer to look at it in a tibble…</p>
</div>
<div class="section level4">
<h4 id="generate-a-tibble-for-correlation-results">Generate a tibble for correlation results<a class="anchor" aria-label="anchor" href="#generate-a-tibble-for-correlation-results"></a>
</h4>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">fst.corr.tibble</span> <span class="op">&lt;-</span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">fst.corr</span>, </span>
<span>    na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    relative <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    pop.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HIERFSTAT"</span>, <span class="st">"STRATAG"</span>, <span class="st">"ASSIGNER"</span>, <span class="st">"DIVERSITY"</span>, <span class="st">"STAMPP"</span>, <span class="st">"GENODIVE"</span>, <span class="st">"SNPRELATE_MEAN"</span>, <span class="st">"SNPRELATE_WEIGHTED"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"CORRELATION"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">CORRELATION</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fst.corr.tibble</span></span></code></pre></div>
<p>Very interesting results!</p>
</div>
<div class="section level4">
<h4 id="figure-of-results">Figure of results<a class="anchor" aria-label="anchor" href="#figure-of-results"></a>
</h4>
<p>Let’s plot the results:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">plot.fst</span> <span class="op">&lt;-</span> <span class="va">fst.summary</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>, col <span class="op">=</span> <span class="va">PAIRS</span>, <span class="va">POP1</span>, <span class="va">POP2</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>, key <span class="op">=</span> <span class="va">SOFTWARE</span>, value <span class="op">=</span> <span class="va">FST</span>, <span class="op">-</span><span class="va">PAIRS</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    SOFTWARE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">SOFTWARE</span>, </span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HIERFSTAT"</span>, <span class="st">"ASSIGNER"</span>, <span class="st">"STAMPP"</span>, <span class="st">"STRATAG"</span>, <span class="st">"DIVERSITY"</span>, <span class="st">"GENODIVE"</span>, <span class="st">"SNPRELATE_WEIGHTED"</span>, <span class="st">"SNPRELATE_MEAN"</span><span class="op">)</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairs.levels</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plot.fst</span>, <span class="va">PAIRS</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>FST <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">FST</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">FST</span><span class="op">)</span> <span class="op"><a href="../../reference/Exposition_pipe_operator.html">%$%</a></span> </span>
<span>  <span class="va">PAIRS</span></span>
<span><span class="va">under.the.sea.palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1C2344"</span>, <span class="st">"#163D7D"</span>, <span class="st">"#118386"</span>, <span class="st">"#89D6D6"</span>, <span class="st">"#6E783D"</span>, <span class="st">"#FC564F"</span>, <span class="st">"#901546"</span>, <span class="st">"#FFD521"</span><span class="op">)</span><span class="co">#, "#010101")</span></span>
<span><span class="va">plot.fst</span> <span class="op"><a href="../../reference/compound_assignment_pipe_operator.html">%&lt;&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PAIRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PAIRS</span>, levels <span class="op">=</span> <span class="va">pairs.levels</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">FST</span>, y <span class="op">=</span> <span class="va">PAIRS</span>, colour <span class="op">=</span> <span class="va">SOFTWARE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">under.the.sea.palette</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="simulated-datasets-10">Simulated datasets<a class="anchor" aria-label="anchor" href="#simulated-datasets-10"></a>
</h3>
<div class="section level4">
<h4 id="sim_01-high-fst">sim_01: high Fst<a class="anchor" aria-label="anchor" href="#sim_01-high-fst"></a>
</h4>
<p><strong>Generate a summary tibble:</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.summary.sim01</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span>  <span class="va">assigner.sim01.fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">diversity.sim01.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">genodive.sim01.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">hierfstat.sim01.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">stampp.sim01.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">stratag.sim01.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">snprelate.sim01.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">.</span>, .predicate <span class="op">=</span> <span class="va">is.numeric</span>, .funs <span class="op">=</span> <span class="va">round</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.summary.sim01</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"fst.summary.sim01.tsv"</span>, col_types <span class="op">=</span> <span class="st">"ccnnnnnnnn"</span><span class="op">)</span></span>
<span><span class="va">fst.summary.sim01</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">##    POP1  POP2  ASSIGNER_SIM01 DIVERSITY_SIM01 GENODIVE_SIM01 HIERFSTAT_SIM01</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> POP_1 POP_2          0.514           0.514          0.514           0.514</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> POP_1 POP_3          0.481           0.481          0.481           0.481</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> POP_1 POP_4          0.425           0.425          0.425           0.425</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> POP_1 POP_5          0.410           0.410          0.410           0.410</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> POP_2 POP_3          0.412           0.412          0.412           0.412</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> POP_2 POP_4          0.370           0.370          0.370           0.370</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> POP_2 POP_5          0.360           0.360          0.360           0.360</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> POP_3 POP_4          0.356           0.356          0.356           0.356</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> POP_3 POP_5          0.341           0.341          0.341           0.341</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> POP_4 POP_5          0.301           0.301          0.301           0.301</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 4 more variables: STAMPP_SIM01 &lt;dbl&gt;, STRATAG_SIM01 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   SNPRELATE_MEAN_SIM01 &lt;dbl&gt;, SNPRELATE_WEIGHTED_SIM01 &lt;dbl&gt;</span></span></span></code></pre>
<p><strong>Generate the correlation tibble:</strong></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.corr.tibble.sim01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fst.summary.sim01</span>, <span class="op">-</span><span class="va">POP1</span>, <span class="op">-</span><span class="va">POP2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">.</span>, </span>
<span>  na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  relative <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  pop.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HIERFSTAT_SIM01"</span>, <span class="st">"STRATAG_SIM01"</span>, <span class="st">"ASSIGNER_SIM01"</span>, <span class="st">"DIVERSITY_SIM01"</span>, <span class="st">"STAMPP_SIM01"</span>, <span class="st">"GENODIVE_SIM01"</span>, <span class="st">"SNPRELATE_MEAN_SIM01"</span>, <span class="st">"SNPRELATE_WEIGHTED_SIM01"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"CORRELATION_SIM01"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">CORRELATION_SIM01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fst.corr.tibble.sim01</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sim_02-low-fst">sim_02: low Fst<a class="anchor" aria-label="anchor" href="#sim_02-low-fst"></a>
</h4>
<p><strong>Generate a summary tibble:</strong></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.summary.sim02</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span>  <span class="va">assigner.sim02.fst</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">diversity.sim02.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">genodive.sim02.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">hierfstat.sim02.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">stampp.sim02.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">stratag.sim02.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">snprelate.sim02.fst</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POP1"</span>, <span class="st">"POP2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">.</span>, .predicate <span class="op">=</span> <span class="va">is.numeric</span>, .funs <span class="op">=</span> <span class="va">round</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.summary.sim02</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"fst.summary.sim02.tsv"</span>, col_types <span class="op">=</span> <span class="st">"ccnnnnnnnn"</span><span class="op">)</span></span>
<span><span class="va">fst.summary.sim02</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">##    POP1  POP2  ASSIGNER_SIM02 DIVERSITY_SIM02 GENODIVE_SIM02 HIERFSTAT_SIM02</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> POP_1 POP_2         0.001           0.001          0.001           0.001 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> POP_1 POP_3         0.003<span style="text-decoration: underline;">2</span>          0.003<span style="text-decoration: underline;">2</span>         0.003<span style="text-decoration: underline;">2</span>          0.003<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> POP_1 POP_4         0.002<span style="text-decoration: underline;">1</span>          0.002<span style="text-decoration: underline;">1</span>         0.002<span style="text-decoration: underline;">1</span>          0.002<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> POP_1 POP_5         0.002<span style="text-decoration: underline;">2</span>          0.002<span style="text-decoration: underline;">2</span>         0.002<span style="text-decoration: underline;">2</span>          0.002<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> POP_2 POP_3         0.000<span style="text-decoration: underline;">1</span>          0.000<span style="text-decoration: underline;">1</span>         0.000<span style="text-decoration: underline;">1</span>          0.000<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> POP_2 POP_4         0.000<span style="text-decoration: underline;">2</span>          0.000<span style="text-decoration: underline;">2</span>         0.000<span style="text-decoration: underline;">2</span>          0.000<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> POP_2 POP_5         0.000<span style="text-decoration: underline;">5</span>          0.000<span style="text-decoration: underline;">5</span>         0.000<span style="text-decoration: underline;">5</span>          0.000<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> POP_3 POP_4         0              -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">6</span>        -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">6</span>         -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">6</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> POP_3 POP_5         0.002<span style="text-decoration: underline;">8</span>          0.002<span style="text-decoration: underline;">8</span>         0.002<span style="text-decoration: underline;">8</span>          0.002<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> POP_4 POP_5         0.001<span style="text-decoration: underline;">7</span>          0.001<span style="text-decoration: underline;">7</span>         0.001<span style="text-decoration: underline;">7</span>          0.001<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 4 more variables: STAMPP_SIM02 &lt;dbl&gt;, STRATAG_SIM02 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   SNPRELATE_MEAN_SIM02 &lt;dbl&gt;, SNPRELATE_WEIGHTED_SIM02 &lt;dbl&gt;</span></span></span></code></pre>
<p><strong>Generate the correlation tibble:</strong></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fst.corr.tibble.sim02</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fst.summary.sim02</span>, <span class="op">-</span><span class="va">POP1</span>, <span class="op">-</span><span class="va">POP2</span><span class="op">)</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span> <span class="fu">radiator</span><span class="fu">::</span><span class="fu"><a href="https://thierrygosselin.github.io/radiator/reference/distance2tibble.html" class="external-link">distance2tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">.</span>, </span>
<span>  na.diag <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  relative <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  pop.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HIERFSTAT_SIM02"</span>, <span class="st">"STRATAG_SIM02"</span>, <span class="st">"ASSIGNER_SIM02"</span>, <span class="st">"DIVERSITY_SIM02"</span>, <span class="st">"STAMPP_SIM02"</span>, <span class="st">"GENODIVE_SIM02"</span>, <span class="st">"SNPRELATE_MEAN_SIM02"</span>, <span class="st">"SNPRELATE_WEIGHTED_SIM02"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_colnames</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"CORRELATION_SIM02"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">CORRELATION_SIM02</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fst.corr.tibble.sim02</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="table-of-features">Table of features<a class="anchor" aria-label="anchor" href="#table-of-features"></a>
</h2>
<p>The table timing was produced using the empirical dataset.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary.table</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"fst_comparisons_packages_features.tsv"</span>, col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html" class="external-link">col_character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary.table</span><span class="op">)</span> <span class="op"><a href="../../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span><span class="op">)</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><em>Note:</em></p>
<ul>
<li>VCFtools: we used only 2 populations and timing is inside VCFtools
only, it doesn’t account for manipulations of output.</li>
<li>SNPRelate: No out-of-the-box pairwise Fst analysis, but very quick
solution is proposed in this vignette.</li>
</ul>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>You could go and look at the 36 pairwise comparisons, but the end of
the story is very simple:</p>
<ul>
<li>For Fst, I’m definitely staying away from VCFtools and SNPRelate
<code>MeanFst</code>.</li>
<li>
<code>SNPRelate</code> MeanFst as a systematic downward bias and the
weighted estimate is usually a little higher.</li>
<li>Empirical and simulated data: <code>assigner</code> and
<code>hierfstat</code> have equal values down to a very large number of
decimals!</li>
<li>The packages show different colors with empirical and simulated
data.
<ul>
<li>contrary to empirical data, with simulated data all the packages
have the same results.</li>
<li>missing data is probably the stats driving those differences.</li>
<li>
<code>assigner</code> and <code>hierfstat</code> show consistent
behaviors in the presence of missing data.</li>
<li>high or low Fst in simulated data: doesn’t impact the packages.</li>
<li>
<code>assigner</code> is different than the others: it transform
<code>-</code> Fst to 0.</li>
<li>it should be worth exploring the impact of missing data patterns and
level of missingness on those Fst calculations…</li>
</ul>
</li>
</ul>
<p>In the absence of missing data, because overall Fst values are
similar, in the end, it’s worth looking at:</p>
<ul>
<li>
<strong>speed</strong>: if this is an issue for you (e.g. if running
multiple simulations, assignment analysis, etc).</li>
<li>
<strong>features</strong>: lots of differences between
packages/software.</li>
</ul>
<p><em>Please let me know if I did something wrong or forgot to mention
an interesting feature of your favorite package.</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thierry Gosselin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
