<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>A fast implementation of Nei's 1987 Fst (overall and paiwise estimates) — fst_NEI87 • assigner</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A fast implementation of Nei's 1987 Fst (overall and paiwise estimates) — fst_NEI87"><meta name="description" content="The function calculates for diploid genomes the classic Nei's Gst (1987),
Nei's G'st (prime), that comes with a correction for the bias that stems
from sampling a limited number of populations. Also calculated is Jost's D,
an index of population differentiation that is independent of the amount of
within-population diversity (Jost, 2008).
Both overall and pairwise Fst can be estimated with
confidence intervals based on bootstrap of markers (resampling with replacement).
The function should give identical results at the 4th decimal when tested
against genet.dist in hierfstat and with
the Fst computed in Calculate Distances or
GenoDive.
The fastest computation is still
GenoDive,
but here, the R solution computes confidence intervals and it's very fast.
The computations takes advantage of tidyverse packages and parallel.
The impact of unbalanced design on estimates can be tested by using the
subsample argument.
Special concerns for genome-wide estimate and filtering bias
During computation, the function first starts by keeping only the polymorphic
markers in common between the populations. Keep this in mind when filtering
your markers to use this function characteristic strategically to get
better genome-wide estimate. This is even more important when your project
involves more than 2 populations that evolved more by neutral processes
(e.g. genetic drift) than by natural selection (see the vignette for more details)."><meta property="og:description" content="The function calculates for diploid genomes the classic Nei's Gst (1987),
Nei's G'st (prime), that comes with a correction for the bias that stems
from sampling a limited number of populations. Also calculated is Jost's D,
an index of population differentiation that is independent of the amount of
within-population diversity (Jost, 2008).
Both overall and pairwise Fst can be estimated with
confidence intervals based on bootstrap of markers (resampling with replacement).
The function should give identical results at the 4th decimal when tested
against genet.dist in hierfstat and with
the Fst computed in Calculate Distances or
GenoDive.
The fastest computation is still
GenoDive,
but here, the R solution computes confidence intervals and it's very fast.
The computations takes advantage of tidyverse packages and parallel.
The impact of unbalanced design on estimates can be tested by using the
subsample argument.
Special concerns for genome-wide estimate and filtering bias
During computation, the function first starts by keeping only the polymorphic
markers in common between the populations. Keep this in mind when filtering
your markers to use this function characteristic strategically to get
better genome-wide estimate. This is even more important when your project
involves more than 2 populations that evolved more by neutral processes
(e.g. genetic drift) than by natural selection (see the vignette for more details)."><meta property="og:image" content="https://thierrygosselin.github.io/assigner/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">assigner</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Installation</a></li>
<li class="nav-item"><a class="nav-link" href="../FEATURES.html">Features</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/get_started.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/fst_confidence_intervals.html">Fst analysis</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/fst_comparisons.html">Comparisons of Fst in 8 packages/software</a></li>
    <li><a class="dropdown-item" href="../articles/assignment.whitelists.html">Using whitelists in assignment</a></li>
    <li><a class="dropdown-item" href="../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/life_cycle.html">Life cycle</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/thierrygosselin/assigner" aria-label="GitHub"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A fast implementation of Nei's 1987 Fst (overall and paiwise estimates)</h1>
      <small class="dont-index">Source: <a href="https://github.com/thierrygosselin/assigner/blob/HEAD/R/fst_NEI87.R" class="external-link"><code>R/fst_NEI87.R</code></a></small>
      <div class="d-none name"><code>fst_NEI87.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function calculates for diploid genomes the classic Nei's Gst (1987),
Nei's G'st (prime), that comes with a correction for the bias that stems
from sampling a limited number of populations. Also calculated is Jost's D,
an index of population differentiation that is independent of the amount of
within-population diversity (Jost, 2008).
Both overall and pairwise Fst can be estimated with
confidence intervals based on bootstrap of markers (resampling with replacement).
The function should give identical results <em>at the 4th decimal</em> when tested
against <code>genet.dist</code> in <code>hierfstat</code> and with
the Fst computed in <code>Calculate Distances</code> or
<a href="http://www.bentleydrummer.nl/software/software/GenoDive.html" class="external-link">GenoDive</a>.
The fastest computation is still
<a href="http://www.bentleydrummer.nl/software/software/GenoDive.html" class="external-link">GenoDive</a>,
but here, the R solution computes confidence intervals and it's very fast.
The computations takes advantage of <span class="pkg">tidyverse</span> packages and <span class="pkg">parallel</span>.
The impact of unbalanced design on estimates can be tested by using the
subsample argument.</p>
<p><em>Special concerns for genome-wide estimate and filtering bias</em></p>
<p>During computation, the function first starts by keeping only the polymorphic
markers in common between the populations. Keep this in mind when filtering
your markers to use this function characteristic strategically to get
better genome-wide estimate. This is even more important when your project
involves more than 2 populations that evolved more by neutral processes
(e.g. genetic drift) than by natural selection (see the vignette for more details).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fst_NEI87</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  pop.levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  holdout.samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pairwise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ci <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  iteration.ci <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  quantiles.ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  subsample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iteration.subsample <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A file in the working directory or object in the global environment
in wide or long (tidy) formats. To import, the function uses internally
<a href="https://github.com/thierrygosselin/radiator" class="external-link">radiator</a>
<code><a href="https://thierrygosselin.github.io/radiator/reference/tidy_wide.html" class="external-link">tidy_wide</a></code>. See details for more info.</p>
<p><em>How to get a tidy data frame ?</em>
<a href="https://github.com/thierrygosselin/radiator" class="external-link">radiator</a>
<code><a href="https://thierrygosselin.github.io/radiator/reference/tidy_genomic_data.html" class="external-link">tidy_genomic_data</a></code> can transform 11 genomic data formats
in a tidy data frame (VCF, PLINK, genind, genlight, gtypes, genepop,
stacks haplotype file, hierfstat, ...).
You can also use this function to filter your dataset using
whitelist of markers, blacklist of individuals and genotypes.</p></dd>


<dt id="arg-pop-levels">pop.levels<a class="anchor" aria-label="anchor" href="#arg-pop-levels"></a></dt>
<dd><p>(optional, string) This refers to the levels in a factor. In this
case, the id of the pop.
Use this argument to have the pop ordered your way instead of the default
alphabetical or numerical order. e.g. <code>pop.levels = c("QUE", "ONT", "ALB")</code>
instead of the default <code>pop.levels = c("ALB", "ONT", "QUE")</code>.
Default: <code>pop.levels = NULL</code>.</p></dd>


<dt id="arg-pop-labels">pop.labels<a class="anchor" aria-label="anchor" href="#arg-pop-labels"></a></dt>
<dd><p>(optional, string) Use this argument to rename/relabel
your pop or combine your pop. e.g. To combine <code>"QUE"</code> and <code>"ONT"</code>
into a new pop called <code>"NEW"</code>:
(1) First, define the levels for your pop with <code>pop.levels</code> argument:
<code>pop.levels = c("QUE", "ONT", "ALB")</code>.
(2) then, use <code>pop.labels</code> argument:
<code>pop.levels = c("NEW", "NEW", "ALB")</code>.#'
To rename <code>"QUE"</code> to <code>"TAS"</code>:
<code>pop.labels = c("TAS", "ONT", "ALB")</code>.
Default: <code>pop.labels = NULL</code>. If you find this too complicated, there is also the
<code>strata</code> argument that can do the same thing, see below.</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>(optional) A tab delimited file with 2 columns with header:
<code>INDIVIDUALS</code> and <code>STRATA</code>.
If a <code>strata</code> file is specified, the strata file will have
precedence over any grouping found input file (<code>data</code>).
The <code>STRATA</code> column can be any hierarchical grouping.
Default: <code>strata = NULL</code>.</p></dd>


<dt id="arg-holdout-samples">holdout.samples<a class="anchor" aria-label="anchor" href="#arg-holdout-samples"></a></dt>
<dd><p>(optional) Samples that don't participate in the Fst
computation (supplementary). Data frame with one column <code>INDIVIDUALS</code>.
Default: <code>holdout.samples = NULL</code>.</p></dd>


<dt id="arg-pairwise">pairwise<a class="anchor" aria-label="anchor" href="#arg-pairwise"></a></dt>
<dd><p>(logical, optional) With <code>pairwise = TRUE</code>, the
pairwise NEI87 Fst is calculated between populations.
Default: <code>pairwise = FALSE</code>.</p></dd>


<dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>(logical, optional) Compute bootstrapped confidence intervals.
Default: <code>ci = FALSE</code>.</p></dd>


<dt id="arg-iteration-ci">iteration.ci<a class="anchor" aria-label="anchor" href="#arg-iteration-ci"></a></dt>
<dd><p>(integer, optional) The number of iterations for
the boostraps (resampling with replacement of markers).
Default: <code>iteration.ci = 100</code>.</p></dd>


<dt id="arg-quantiles-ci">quantiles.ci<a class="anchor" aria-label="anchor" href="#arg-quantiles-ci"></a></dt>
<dd><p>(double, optional)
The quantiles for the bootstrapped confidence intervals.
Default: <code>quantiles.ci = c(0.025,0.975)</code>.</p></dd>


<dt id="arg-subsample">subsample<a class="anchor" aria-label="anchor" href="#arg-subsample"></a></dt>
<dd><p>(Integer or character)
With <code>subsample = 36</code>, 36 individuals in each populations are chosen
randomly to represent the dataset. With <code>subsample = "min"</code>, the
minimum number of individual/population found in the data is used automatically.
Default is no subsampling, <code>subsample = NULL</code>.</p></dd>


<dt id="arg-iteration-subsample">iteration.subsample<a class="anchor" aria-label="anchor" href="#arg-iteration-subsample"></a></dt>
<dd><p>(Integer) The number of iterations to repeat
subsampling.
With <code>subsample = 20</code> and <code>iteration.subsample = 10</code>,
20 individuals/populations will be randomly chosen 10 times.
Default: <code>iteration.subsample = 1</code>.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>(optional, integer) The number of decimal places to be used in
results.
Default: <code>digits = 9</code>.</p></dd>


<dt id="arg-parallel-core">parallel.core<a class="anchor" aria-label="anchor" href="#arg-parallel-core"></a></dt>
<dd><p>(optional) The number of core for parallel computation
of pairwise Fst.
If not selected <code>detectCores() - 1</code> is used as default.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>(logical, optional) <code>verbose = TRUE</code> to be chatty
during execution.
Default: <code>verbose = FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other parameters passed to the function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a list with several objects.
When sumsample is selected the objects end with <code>.subsample</code>.</p><ul><li><p><code>$subsampling.individuals</code>: the combinations of individuals and subsamples,</p></li>
<li><p><code>$fst.markers</code>: Nei's Gst, Nei's G'st and Jost's D by markers,</p></li>
<li><p><code>$fst.ranked</code>: Nei's Gst, Nei's G'st and Jost's D by markers ranked by Nei's Gst,</p></li>
<li><p><code>$fst.overall</code>: the overall Nei's Gst, Nei's G'st and Jost's D by markers with confidence intervals.</p></li>
<li><p><code>$fis.markers</code>: the fis by markers,</p></li>
<li><p><code>$fis.overall</code>: the mean fis overall markers with confidence intervals and the number of markers,</p></li>
<li><p><code>$fst.plot</code>: the histogram of the overall G'st per markers,</p></li>
<li><p><code>$pairwise.fst</code>: pairwise Nei's Gst, Nei's G'st and Jost's D in long/tidy data frame and the number of markers ,</p></li>
<li><p><code>$pairwise.fst.upper.matrix</code>: the pairwise fst prime in a upper triangle matrix,</p></li>
<li><p><code>$pairwise.fst.full.matrix</code>: the pairwise fst prime matrix (duplicated upper and lower triangle),</p></li>
<li><p><code>$pairwise.fst.ci.matrix</code>: matrix with pairwise fst prime in the upper triangle
 and the confidence intervals in the lower triangle.</p></li>
<li><p>when subsample is selected <code>$pairwise.fst.subsample.mean</code> is a summary
 of all pairwise comparisons subsample. The mean is calculated accross summary
 statistics.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Input data:</strong></p>
<p>To discriminate the long from the wide format,
the function <span class="pkg">radiator</span> <code><a href="https://thierrygosselin.github.io/radiator/reference/tidy_wide.html" class="external-link">tidy_wide</a></code> searches
for <code>MARKERS or LOCUS</code> in column names (TRUE = long format).
The data frame is tab delimitted.
<strong>Wide format:</strong>
The wide format cannot store metadata info.
The wide format starts with these 2 id columns:
<code>INDIVIDUALS</code>, <code>STRATA</code> (that refers to any grouping of individuals),
the remaining columns are the markers in separate columns storing genotypes.</p>
<p><strong>Long/Tidy format:</strong>
The long format is considered to be a tidy data frame and can store metadata info.
(e.g. from a VCF see <span class="pkg">radiator</span> <code><a href="https://thierrygosselin.github.io/radiator/reference/tidy_genomic_data.html" class="external-link">tidy_genomic_data</a></code>). A minimum of 4 columns
are required in the long format: <code>INDIVIDUALS</code>, <code>STRATA</code>,
<code>MARKERS or LOCUS</code> and <code>GENOTYPE or GT</code>. The rest are considered metata info.</p>
<p><strong>2 genotypes formats are available:</strong>
6 characters no separator: e.g. <code>001002 of 111333</code> (for heterozygote individual).
6 characters WITH separator: e.g. <code>001/002 of 111/333</code> (for heterozygote individual).
The separator can be any of these: <code>"/", ":", "_", "-", "."</code>.</p>
<p><em>How to get a tidy data frame ?</em>
<span class="pkg">radiator</span> <code><a href="https://thierrygosselin.github.io/radiator/reference/tidy_genomic_data.html" class="external-link">tidy_genomic_data</a></code> can transform 6 genomic data formats
in a tidy data frame.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><strong>Negative Fst</strong> are technical artifact of the computation
(see Roesti el al. 2012) and are automatically replaced with zero inside
this function.</p>
<p><strong>Why no p-values ?</strong></p>
<p>There is no null hypothesis testing with <em>P</em>-values.
Confidence intervals provided with the <em>F</em>-statistics
enables more reliable conclusions about the biological trends in the data.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nei M. (1987) Molecular Evolutionary Genetics.
Columbia University Press</p>
<p>Meirmans PG, Van Tienderen PH (2004) genotype and genodive:
two programs for the analysis of genetic diversity of asexual organisms.
Molecular Ecology Notes, 4, 792-794.</p>
<p>Roesti M, Salzburger W, Berner D. (2012)
Uninformative polymorphisms bias genome scans for signatures of selection.
BMC Evol Biol., 12:94. doi:10.1111/j.1365-294X.2012.05509.x</p>
<p>Jost L. (2008)
G(ST) and its relatives do not measure differentiation.
Molecular Ecology. 17: 4015-4026.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>From <a href="http://www.bentleydrummer.nl/software/software/GenoDive.html" class="external-link">GenoDive</a> manual:
<em>'In general, rather than to test differentiation between all pairs of
populations,
it is adviseable to perform an overall test of population differentiation,
possibly using a hierarchical population structure, (see AMOVA)'</em></p>
<p>To compute an AMOVA, use <a href="http://www.bentleydrummer.nl/software/software/GenoDive.html" class="external-link">GenoDive</a></p>
<p><a href="https://github.com/jgx65/hierfstat/" class="external-link">hierfstat</a></p>
<p>Link for <a href="http://www.bentleydrummer.nl/software/software/GenoDive.html" class="external-link">GenoDive</a></p>
<p>For Fisher's exact test and p-values per markers
see <code>mmod</code> <code>diff_test</code>.</p>
<p><code><a href="https://thierrygosselin.github.io/radiator/reference/tidy_genomic_data.html" class="external-link">tidy_genomic_data</a></code> to transform numerous genomic data
format in tidy data frames.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thierry Gosselin <a href="mailto:thierrygosselin@icloud.com">thierrygosselin@icloud.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://thierrygosselin.github.io/assigner/">assigner</a></span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">wombat.fst.pairwise</span> <span class="op">&lt;-</span> <span class="fu">fst_NEI87</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="st">"wombat.filtered.tidy.tsv"</span>,</span></span>
<span class="r-in"><span> sep <span class="op">=</span> <span class="st">"/"</span>,</span></span>
<span class="r-in"><span> pop.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ATL"</span>, <span class="st">"MLE"</span>, <span class="st">"BIS"</span>, <span class="st">"PMO"</span>, <span class="st">"SOL"</span>, <span class="st">"TAS"</span>, <span class="st">"ECU"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> holdout.samples <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span> pairwise <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span> ci <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span> iteration.ci <span class="op">=</span> <span class="fl">10000</span>,</span></span>
<span class="r-in"><span> quantiles.ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> parallel.core <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span> verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co">#To get the overall Fst estimate:</span></span></span>
<span class="r-in"><span> <span class="va">wombat.fst.pairwise</span><span class="op">$</span><span class="va">fst.overall</span></span></span>
<span class="r-in"><span> <span class="co">#To get the Fst plot:</span></span></span>
<span class="r-in"><span> <span class="va">wombat.fst.pairwise</span><span class="op">$</span><span class="va">fst.plots</span></span></span>
<span class="r-in"><span> <span class="co">#To get the pairwise Fst values with confidence intervals in a data frame:</span></span></span>
<span class="r-in"><span> <span class="va">wombat.fst.pairwise</span><span class="op">$</span><span class="va">pairwise.fst</span></span></span>
<span class="r-in"><span> <span class="co">#To get the pairwise fst and ci matrix in a data frame:</span></span></span>
<span class="r-in"><span> <span class="co"># rename, data frame, put rownames in column</span></span></span>
<span class="r-in"><span> <span class="va">pairwise.fst.ci.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">pairwise.fst.ci.matrix</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">add_rownames</span><span class="op">(</span><span class="st">"POP"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thierry Gosselin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

